!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.router=t()}(this,function(){"use strict";function n(n){return"#"!==n[0]&&(n="#"+n),n.length>2&&"/"===n.slice(-1)?n.slice(0,-1):n}return function(t,r){function e(n){return"function"==typeof n?n:r}function i(n){return n.replace(/^#?\/*(.*)\/*$/,"$1").toLowerCase().split("/")}function u(n,t){for(var e=i(n),u={},o=p,a=0;a<e.length;a++){var h=t(e[a]),s=h in o?h:":"in o?":":"*";if(!(o=o[s]))return r;if("*"===s)break;o["~"]&&(u[o["~"]]=h)}return(o=o["@"]).params=u,o}function o(n,t,r){if(t&&n)for(var e=t.split("&"),i=0;i<e.length;i++){var u=e[i].split("=");n.params[u[0]]=r(u[1])}return n}function a(t,r){var e=n(t.path),u=p;return i(e).forEach(function(n){var t=":"===n[0]?":":0,r=t||n;u=u[r]||(u[r]={}),t&&(u["~"]=n.slice(1))}),u=u["@"]={enter:r},t&&Object.keys(t).forEach(function(n){u[n]="path"===n?e:t[n]}),u}var h,s,c,f=t.location,l=t.decodeURIComponent,d=function(n){return n},p={},v={},m={reset:function(){return this.clear(),v.hash="",v.route=h=s=c=r,this},clear:function(){return Object.keys(p).forEach(function(n){delete p[n]}),this},concat:function(n,t){return t=e(t),Array.isArray(n)?n.forEach(function(n){a(n,t)}):a(n,t),this},rescue:function(n){return h=e(n),this},enter:function(n){return s=e(n),this},exit:function(n){return c=e(n),this},route:function t(e){for(var u=i(n(e)),t=p,o=0;o<u.length;o++){var a=u[o];if(!(t=t[":"===a[0]?":":a]))return r}return t["@"]},match:function(n){var t=n.split("?"),r=n.indexOf("%")<0?d:l;return o(u(t[0],r),t[1],r)},_run:function(t){if(t=n(t),v.hash!==t){var r=v.route,e=this.match(t);if(r&&r.exit&&r.exit()===!1)return!1;if(c&&c.call(this,r),e&&(e.hash=t),v.hash=t,v.route=e,s&&s.call(this,e),e&&e.enter)return e.enter(e.params);h&&h.call(this,t)}return!1},navigate:function(t,r){return r&&(v.hash="@"),r&&n(f.hash)===n(t)?this._run(t):f.hash=t,this},_handler:function(){m._run(f.hash)},listen:function(r){if(!f.hash&&r&&(f.hash=n(r)),!("onhashchange"in t))throw new Error("easyRouter: Your browser has no hashchange support");return t.addEventListener("hashchange",m._handler,!0),f.hash&&this._run(f.hash),this}};return m.add=m.concat,m.reset()}(window)});