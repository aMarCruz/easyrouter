!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.router=t()}(this,function(){"use strict";return function(n,t){function r(n){return"function"==typeof n?n:t}function e(n){return"#"!==n[0]&&(n="#"+n),n.length>2&&"/"===n.slice(-1)?n.slice(0,-1):n}function i(n){return n.replace(/^#?\/*(.*)\/*$/,"$1").toLowerCase().split("/")}function u(n,r){for(var e=i(n),u={},o=v,a=0;a<e.length;a++){var h=r(e[a]),c=h in o?h:":"in o?":":"*";if(!(o=o[c]))return t;if("*"===c)break;o["~"]&&(u[o["~"]]=h)}return(o=o["@"]).params=u,o}function o(n,t,r){if(t&&n)for(var e=t.split("&"),i=0;i<e.length;i++){var u=e[i].split("=");n.params[u[0]]=r(u[1])}return n}function a(n,t){var r=e(n.path),u=v;return i(r).forEach(function(n){var t=":"===n[0]?":":0,r=t||n;u=u[r]||(u[r]={}),t&&(u["~"]=n.slice(1))}),u=u["@"]={enter:t},n&&Object.keys(n).forEach(function(t){u[t]="path"===t?r:n[t]}),u}var h,c,s,f=n.location,l=n.decodeURIComponent,p=function(n){return n},d={},v={},g={reset:function(){return this.clear(),d.hash="",d.route=h=c=s=t,this},clear:function(){return v={},this},concat:function(n,t){return t=r(t),Array.isArray(n)?n.forEach(function(n){a(n,t)}):a(n,t),this},rescue:function(n){return h=r(n),this},enter:function(n){return c=r(n),this},exit:function(n){return s=r(n),this},route:function n(r){for(var u=i(e(r)),n=v,o=0;o<u.length;o++){var a=u[o];if(!(n=n[":"===a[0]?":":a]))return t}return n["@"]},match:function(n){var t=n.split("?"),r=n.indexOf("%")<0?p:l;return o(u(t[0],r),t[1],r)},_run:function(n){if(n=e(n),d.hash!==n){var t=d.route,r=this.match(n);if(t&&t.exit&&t.exit()===!1)return!1;if(s&&s.call(this,t),r&&(r.hash=n),d.hash=n,d.route=r,c&&c.call(this,r),r&&r.enter)return r.enter(r.params),!0;h&&h.call(this,n)}return!1},navigate:function(n,t){return t&&(d.hash="@"),t&&e(f.hash)===e(n)?this._run(n):f.hash=n,this},get _routes(){return v},_handler:function(){g._run(f.hash)},listen:function(t){if(!("onhashchange"in n))throw new Error("easyRouter: Your browser has no hashchange support");return n.addEventListener("hashchange",g._handler,!0),t&&(t=e(t),h||(h=function(){f.hash=t})),f.hash?this._run(f.hash):t&&(f.hash=t),this}};return g.add=g.concat,g.reset()}(window)});